<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bluesky Term Search</title>
    <link rel="preconnect" href="https://public.api.bsky.app" crossorigin>
    <link rel="preconnect" href="https://cdn.bsky.app" crossorigin>
    <link rel="stylesheet" href="/styles.min.css">
</head>

<body>
    <a href="#results" class="skip-link">Skip to results</a>
    <div class="page-header">
        <div class="title-block">
            <h1>Bluesky Term Search</h1>
            <p class="subtitle">Search posts filtered by time and engagement</p>
        </div>
        <div class="theme-control">
            <label for="themeSelect">Theme</label>
            <select id="themeSelect">
                <option value="light">Light</option>
                <option value="dark">Dark</option>
                <option value="system" selected>System</option>
            </select>
        </div>
    </div>
    <!-- Search Form -->
    <div class="search-form">
        <div class="form-row">
            <div class="form-group">
                <label for="terms">Search Terms (comma-separated)</label>
                <input type="text" id="terms" placeholder="Enter search termsâ€¦" autocomplete="off" spellcheck="false" />
            </div>
        </div>
        <div class="form-row">
            <div class="form-group">
                <div class="label-row">
                    <label for="expandTermsToggle">Phrase Expansion</label>
                    <span class="info-trigger">
                        <button type="button" class="info-button" aria-label="Phrase expansion summary" aria-describedby="expandSummary">i</button>
                        <span id="expandSummary" class="info-tooltip" role="tooltip"></span>
                    </span>
                </div>
                <div class="checkbox-inline">
                    <input type="checkbox" id="expandTermsToggle" />
                    <span>Also search each word in multi-word phrases</span>
                </div>
            </div>
        </div>
        <div class="form-row align-bottom">
            <div class="form-group small">
                <label for="minLikes">Min. Likes</label>
                <input type="number" id="minLikes" value="10" min="0" autocomplete="off" />
            </div>
            <div class="form-group small">
                <label for="timeFilter">Time Range</label>
                <select id="timeFilter">
                    <option value="1">1 hour</option>
                    <option value="6">6 hours</option>
                    <option value="12">12 hours</option>
                    <option value="24" selected>24 hours</option>
                    <option value="48">48 hours</option>
                    <option value="168">7 days</option>
                </select>
            </div>
            <div class="form-group small">
                <label for="sortSelect">Sort</label>
                <select id="sortSelect">
                    <option value="top" selected>Top</option>
                    <option value="latest">Latest</option>
                </select>
            </div>
            <button type="button" id="searchBtn">Search</button>
        </div>
        <div class="form-row refresh-row">
            <div class="form-group small">
                <label for="autoRefreshToggle">Auto-refresh</label>
                <div class="checkbox-inline">
                    <input type="checkbox" id="autoRefreshToggle" />
                    <span>Enable</span>
                </div>
            </div>
            <div class="form-group small">
                <label for="refreshInterval">Interval</label>
                <select id="refreshInterval">
                    <option value="2">2 min</option>
                    <option value="5" selected>5 min</option>
                    <option value="10">10 min</option>
                    <option value="30">30 min</option>
                </select>
            </div>
            <div class="form-group refresh-status">
                <label>Refresh Status</label>
                <div class="refresh-meta">
                    <div id="refreshState" class="refresh-state">Auto-refresh off</div>
                    <div id="refreshLast">Last updated: --</div>
                    <div id="refreshNext"></div>
                </div>
            </div>
            <div class="form-group small refresh-link">
                <a class="thread-link" href="https://bskyfeed-watch.fly.dev/" target="_blank" rel="noopener noreferrer">Custom keyword feed</a>
            </div>
        </div>
    </div>

    <div id="status" class="status" role="status" aria-live="polite" aria-atomic="true"></div>
    <div id="newPosts" class="new-posts hidden" role="status" aria-live="polite" aria-atomic="true"></div>
    <div id="results" role="region" aria-label="Search results"></div>

    <section class="quote-section" id="quoteSection">
        <h2>Quote Finder</h2>
        <p class="subtitle quote-subtitle">Find all quotes of a Bluesky post</p>

        <form id="quoteForm" class="quote-form">
            <div class="form-row align-bottom">
                <div class="form-group">
                    <label for="postUrl">Bluesky Post URL</label>
                    <input type="url" id="postUrl" placeholder="https://bsky.app/profile/handle/post/abc123" autocomplete="off" spellcheck="false" required />
                </div>
                <button type="submit" id="quoteSearchBtn">Find Quotes</button>
            </div>
        </form>

        <div id="quoteStatus" class="status" role="status" aria-live="polite" aria-atomic="true"></div>
        <div id="quoteTabs" class="quote-tabs" role="tablist" aria-label="Quote sort order">
            <button type="button" class="quote-tab active" data-sort="likes" role="tab" aria-selected="true">Most Likes</button>
            <button type="button" class="quote-tab" data-sort="recent" role="tab" aria-selected="false">Most Recent</button>
            <button type="button" class="quote-tab" data-sort="oldest" role="tab" aria-selected="false">Oldest First</button>
        </div>
        <div id="quoteOriginal"></div>
        <div id="quoteCount" class="quote-count"></div>
        <div id="quoteResults"></div>
        <div id="quoteLoadMore"></div>
    </section>

    <script src="/app.min.js" defer></script>
</body>

</html>
